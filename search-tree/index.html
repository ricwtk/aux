<!DOCTYPE html><html><head> <meta charset="utf-8"> <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet"> <link href="https://cdn.jsdelivr.net/npm/@mdi/font@5.x/css/materialdesignicons.min.css" rel="stylesheet"> <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"> <title>Search tree</title></head><body> <div id="app"> <v-app> <v-main> <v-container fluid style="width: 100vw; height: 100vh" class="d-flex flex-column align-center"> <v-sheet width="100%" height="100%" class="d-flex flex-column"> <v-row class="flex-grow-0" no-gutters> <v-col> <v-text-field label="Student ID" v-model="studentId" readonly outlined hide-details flat dense class="align-center"> <template v-slot:append-outer> <v-btn icon @click="studentId_overlay=true" title="edit settings"><v-icon>mdi-pencil</v-icon></v-btn> </template> <template v-slot:prepend> <v-btn icon href="./help" target="_blank" title="documentation"><v-icon>mdi-help-circle</v-icon></v-btn> </template> </v-text-field> </v-col> </v-row> <v-row class="flex-grow-0 justify-center" no-gutters> <v-btn large icon @click="stsvg.tree_width=Math.max(5, stsvg.tree_width - 3)"><v-icon>mdi-magnify-minus-outline</v-icon></v-btn> <v-btn large icon @click="stsvg.tree_width=stsvg.tree_width_reset"><v-icon>mdi-magnify-remove-outline</v-icon></v-btn> <v-btn large icon @click="stsvg.tree_width +=3"><v-icon>mdi-magnify-plus-outline</v-icon></v-btn> </v-row> <v-row class="" style="overflow:auto"> <v-col class="text-center"> <svg :width="`${stsvg.tree_width}%`" :view-box.camel="search_tree_view_box"> <svg:style> .expseq{font: normal 10px sans-serif;}</svg:style> <template v-if="search_tree.length==0"> <image x="0" y="0" :width="stsvg.prop.node_width" :height="stsvg.prop.node_height" href="https://cdn.jsdelivr.net/npm/@mdi/svg@5.x/svg/plus.svg" @click="addChild()" ><title>Add child</title></image> </template> <template v-else v-for="layer,l in search_tree_array.slice(0,search_tree_array.length-1)"> <template v-for="node,n in layer.flat(2)"> <rect :key="'node-'+l+'-'+n" :x="node_x[l][n]" :y="l*(stsvg.prop.node_height+stsvg.prop.link_height)" :width="stsvg.prop.node_width" :height="stsvg.prop.node_height" v-if="!(node < 1)" stroke="gray" fill="white" ></rect> <text v-if="!(node < 1)" :key="'nodelabel-'+l+'-'+n" :x="node_x[l][n] + .5*stsvg.prop.node_width" :y="l*(stsvg.prop.node_height+stsvg.prop.link_height) + .5*stsvg.prop.node_height" font-weight="thin" dominant-baseline="middle" text-anchor="middle" >{{node.state}}</text> <text v-if="!(node < 1) && (node.expansionsequence > 0)" :key="'nodelabel-expseq-'+l+'-'+n" :x="node_x[l][n] + .5*stsvg.prop.node_width + .75*stsvg.prop.node_width" :y="l*(stsvg.prop.node_height+stsvg.prop.link_height) + .5*stsvg.prop.node_height" font-weight="thin" dominant-baseline="middle" text-anchor="middle" class="expseq" >{{node.expansionsequence}}</text> <circle v-if="!(node < 1) && (node.expansionsequence > 0)" :key="'nodelabel-expseq-circle-'+l+'-'+n" :cx="node_x[l][n] + .5*stsvg.prop.node_width + .75*stsvg.prop.node_width" :cy="l*(stsvg.prop.node_height+stsvg.prop.link_height) + .5*stsvg.prop.node_height" :r=".2*stsvg.prop.node_width" fill="none" stroke="#009688" ></circle> <line v-if="node.removed" stroke="red" stroke-width="3" :x1="node_x[l][n] - .1*stsvg.prop.node_width" :y1="l*(stsvg.prop.node_height+stsvg.prop.link_height) - .1*stsvg.prop.node_height" :x2="node_x[l][n] + stsvg.prop.node_width + .1*stsvg.prop.node_width" :y2="l*(stsvg.prop.node_height+stsvg.prop.link_height) + stsvg.prop.node_height + .1*stsvg.prop.node_height" ></line> <line v-if="node.removed" stroke="red" stroke-width="3" :x1="node_x[l][n] + stsvg.prop.node_width + .1*stsvg.prop.node_width" :y1="l*(stsvg.prop.node_height+stsvg.prop.link_height) - .1*stsvg.prop.node_height" :x2="node_x[l][n] - .1*stsvg.prop.node_width" :y2="l*(stsvg.prop.node_height+stsvg.prop.link_height) + stsvg.prop.node_height + .1*stsvg.prop.node_height" ></line> <line v-if="(l > 0) && !(node < 1)" :key="'link-'+l+'-'+n" :x1="linkage[l-1][n].parent_loc+.5*stsvg.prop.node_width" :y1="(l-1)*(stsvg.prop.node_height+stsvg.prop.link_height)+stsvg.prop.node_height" :x2="linkage[l-1][n].child_loc+.5*stsvg.prop.node_width" :y2="l*(stsvg.prop.node_height+stsvg.prop.link_height)" stroke="gray"/> <text v-if="(l > 0) && !(node < 1)" :key="'linklabel-'+l+'-'+n" :x="(linkage[l-1][n].parent_loc+linkage[l-1][n].child_loc)/2 + .5*stsvg.prop.node_width" :y="l*(stsvg.prop.node_height+stsvg.prop.link_height) - .5*stsvg.prop.link_height" stroke="white" stroke-width=".5pt" font-weight="900" dominant-baseline="middle" text-anchor="middle" >{{linkage[l-1][n].label}}</text> </template> </template> <template v-for="layer,l in search_tree_array.slice(0,search_tree_array.length-1)"> <template v-for="node,n in layer.flat(2)"> <image :key="'node-over-setting-'+l+'-'+n" :x="node_x[l][n]" :y="l*(stsvg.prop.node_height+stsvg.prop.link_height)" :width="stsvg.prop.node_width" :height="stsvg.prop.node_height" v-if="!(node < 1)" :opacity="hoveredCheckOpac(l,n)" href="https://cdn.jsdelivr.net/npm/@mdi/svg@5.x/svg/pencil.svg" @mouseover="hoveredAdd(l,n)" @mouseleave="hoveredRemove()" @click="editNode(node)" ><title>{{node.state}}</title></image> <image :key="'node-add-child-'+l+'-'+n" :x="node_x[l][n]" :y="l*(stsvg.prop.node_height+stsvg.prop.link_height)+stsvg.prop.node_height" :width="stsvg.prop.node_width" :height="stsvg.prop.node_height" v-if="!(node < 1)" :opacity="hoveredAddChildCheckOpac(l,n)" href="https://cdn.jsdelivr.net/npm/@mdi/svg@5.x/svg/plus.svg" @mouseover="hoveredAddChildAdd(l,n)" @mouseleave="hoveredAddChildRemove()" @click="addChild(node)" ><title>Add child</title></image> </template> </template> </svg> </v-col> </v-row> <v-row class="flex-grow-0" no-gutters> <v-col class="mr-2"><v-btn block color="" @click="upload.overlay=true" dark>Upload</v-btn></v-col> <v-col><v-btn block color="primary" @click="download">Download</v-btn></v-col> </v-row> </v-sheet> <v-dialog v-model="studentId_overlay"> <v-card> <v-card-title></v-card-title> <v-card-text> <v-text-field label="Student ID" v-model="studentId" outlined persistent-hint hint="Any changes to the student ID will remove all manually inserted data"></v-text-field> </v-card-text> <v-card-actions> <v-spacer></v-spacer> <v-btn color="primary" @click="studentId_overlay=false">Ok</v-btn> </v-card-actions> </v-card> </v-dialog> <v-dialog v-model="edit_data.overlay"> <v-card v-if="edit_data.index < search_tree.length"> <v-card-title>&nbsp;{{search_tree[edit_data.index].state}}</v-card-title> <v-card-text> <template v-for="el,ei in data_details"> <v-row v-if="el.type !=='boolean'"> <v-col cols="auto" class="subtitle-2">{{el.label}}</v-col> <v-col> <v-tooltip right> <template v-slot:activator="{on, attrs}"> <v-icon icon v-on="on" v-bind="attrs" small>mdi-help-circle-outline</v-icon> </template> <span>{{el.docstring}}</span> </v-tooltip> </v-col> </v-row> <v-text-field v-if="el.type=='text'" v-model="search_tree[edit_data.index][el.key]" outlined hide-details solo flat></v-text-field> <v-text-field v-if="el.type=='integer'" type="number" v-model="search_tree[edit_data.index][el.key]" hide-details outlined solo flat></v-text-field> <v-switch v-if="el.type=='boolean'" v-model="search_tree[edit_data.index][el.key]" inset> <template v-slot:label> <v-col cols="auto" class="subtitle-2 my-0 py-0">{{el.label}}</v-col> <v-col class="my-0 py-0"> <v-tooltip right> <template v-slot:activator="{on, attrs}"> <v-icon icon v-on="on" v-bind="attrs" small>mdi-help-circle-outline</v-icon> </template> <span>{{el.docstring}}</span> </v-tooltip> </v-col> </template> </v-switch> <v-textarea v-if="el.type=='textarea'" v-model="search_tree[edit_data.index][el.keyl]" outlined hide-details solo flat></v-textarea> <v-select v-if="el.type=='unrepeatable choice'" v-model="search_tree[edit_data.index][el.key]" :items="el.options" multiple hide-details outlined deletable-chips chips solo flat></v-select> <template v-if="el.type=='repeatable choice'"> <v-row v-for="ci in search_tree[edit_data.index][el.key].length" :key="`editdata-${ei}-${ci}`" no-gutters> <v-col><v-select :items="el.options" v-model="search_tree[edit_data.index][el.key][ci-1]" hide-details outlined solo flat dense class="align-center"> <template v-slot:append-outer> <v-btn icon @click="search_tree[edit_data.index][el.key].splice(ci-1,1)"><v-icon>mdi-minus</v-icon></v-btn> </template> <template v-slot:prepend> <v-btn icon @click="search_tree[edit_data.index][el.key].splice(ci-1,0,el.options[0])"><v-icon>mdi-plus</v-icon></v-btn> </template> </v-select></v-col> </v-row> <v-row><v-col><v-btn block @click="search_tree[edit_data.index][el.key].push(el.options[0])"><v-icon>mdi-plus</v-icon></v-btn></v-col></v-row> </template> <template v-if="el.type=='fix-edit pairs'"> <template v-if="search_tree[edit_data.index][el.keys[0]].length > 0"> <v-row v-for="ci in search_tree[edit_data.index][el.keys[0]].length" :key="`editdata-${ei}-${ci}`" no-gutters> <v-col> <v-text-field :label="el.labelfunction([search_tree[edit_data.index][el.keys[0]][ci-1], search_tree[edit_data.index][el.keys[1]][ci-1]])" v-model="search_tree[edit_data.index][el.keys[1]][ci-1]"> <template v-slot:prepend v-if="el.movable"> <v-btn icon @click="el.moveup(el.keys,ci-1)" :disabled="ci==1"><v-icon>mdi-arrow-up-bold</v-icon></v-btn> <v-btn icon @click="el.movedown(el.keys,ci-1)" :disabled="ci==search_tree[edit_data.index][el.keys[0]].length"><v-icon>mdi-arrow-down-bold</v-icon></v-btn> </template> </v-text-field> </v-col> </v-row> </template> <v-row v-else> <v-col class="text-center">The actions to the children of this node will be displayed here after the children are added.</v-col> </v-row> </template> </template> <v-btn block color="error" @click="deleteNode()">Delete</v-btn> </v-card-text> </v-card> </v-dialog> <v-dialog v-model="upload.overlay"> <v-card> <v-card-title></v-card-title> <v-card-text> <v-alert type="info">You only need this function if the website has crashed.</v-alert> <v-row><v-col>This function is only for uploading your previously downloaded files.</v-col></v-row> <v-file-input v-model="upload.file" label="Upload file"></v-file-input> <v-alert type="error" v-if="upload.error.length > 0">{{upload.error}}</v-alert> </v-card-text> <v-card-actions> <v-spacer></v-spacer> <v-btn color="primary" @click="upload_file">Upload</v-btn> </v-card-actions> </v-card> </v-dialog> </v-container> </v-main> </v-app> </div><script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script> <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script> <script>let vm=new Vue({el: '#app', vuetify: new Vuetify(), data:{stsvg:{prop:{node_height: 50, node_width: 50, link_height: 50, node_sep: 50}, tree_width: 30, tree_width_reset: 30}, studentId: "00000000", studentId_overlay: true, search_tree: [], sample_data: [{id: 1, state: "0, 0", children: [2, 3], actions: ["e", "n"], removed: false, parent: null, expansionsequence: 1,},{id: 2, state: "1, 0", children: [4, 5], actions: ["w", "n"], removed: false, parent: 1, expansionsequence: -1,},{id: 3, state: "0, 1", children: [], actions: [], removed: false, parent: 1, expansionsequence: 3,},{id: 4, state: "0, 0", children: [], actions: [], removed: true, parent: 2, expansionsequence: 2,},{id: 5, state: "1, 1", children: [], actions: [], removed: false, parent: 2, expansionsequence: -1,}], data_details: [{label: "State", key: "state", type: "text", docstring: "State of this node"},{label: "Expansion sequence", key: "expansionsequence", type: "integer", docstring: "Sequence of expansion (-1 for unexpanded)",},{label: "Removed", key: "removed", docstring: "Is this node removed from the frontier? (duplicated or redundant)", type: "boolean"},{label: "Child-Action", type: "fix-edit pairs", movable: true, keys: ["children", "actions"], types: ["id", "text"], docstring: "Choose the action that leads to the child", labelfunction: null, moveup: null, movedown: null,}], default_node:{id: 1, state: "-1,-1", expansionsequence: -1, children: [], actions: [], removed: false, parent: null}, edit_data:{overlay: false, index: 0}, upload:{overlay: false, file: undefined, error: ""}, st_data:{hovered_node: [-1,-1], hovered_add_child_node: [-1,-1]}}, mounted: function (){this.data_details[3].labelfunction=this.labelForChildAction; this.data_details[3].moveup=this.moveUpChildAction; this.data_details[3].movedown=this.moveDownChildAction; this.init_data(); this.search_tree=this.sample_data;}, watch:{studentId: function (){console.log("Student ID updated"); this.init_data();},}, computed:{sd: function (){return this.studentId;}, search_tree_view_box: function (){let vb="0 0 0 0"; if (this.search_tree_array.length > 0){let width=this.search_tree_array[this.search_tree_array.length - 1].length * this.stsvg.prop.node_width + (this.search_tree_array[this.search_tree_array.length - 1].length - 1) * this.stsvg.prop.node_sep + 10 + .5*this.stsvg.prop.node_width + .1*this.stsvg.prop.node_width; let height=(this.search_tree_array.length - 1)* this.stsvg.prop.node_height + (this.search_tree_array.length - 2) * this.stsvg.prop.link_height + 10 + this.stsvg.prop.node_height + .1*this.stsvg.prop.node_height; vb=`-${.1*this.stsvg.prop.node_width}-${5+.1*this.stsvg.prop.node_height}${width}${height}`;}else{vb=`0 0 ${this.stsvg.prop.node_width}${this.stsvg.prop.node_height}`;}return vb;}, search_tree_array: function (){let st_arr=[]; if (this.search_tree.length > 0){st_arr.push([[this.search_tree.find(v=> !v.parent)]]); while (!st_arr[st_arr.length - 1].every(arr=> arr.every(v=> v < 1))){st_arr.push( st_arr[st_arr.length - 1].flat() .map(n=> n < 1 ? [n - 1] : (n.children.length==0 ? [0] : n.children.map(i=> this.search_tree.find(v=> v.id==i)).filter(v=> v !==undefined)) ) );}}return st_arr;}, node_x: function (){let x=[]; if (this.search_tree_array.length > 0){x.push(this.search_tree_array[this.search_tree_array.length - 2].flat().map((node,n)=> n * (this.stsvg.prop.node_width + this.stsvg.prop.node_sep) + 5)); for ( let i=this.search_tree_array.length - 3; i > -1; i-- ){x.push( this.search_tree_array[i].flat().map((node,n)=>{let first_child_idx=this.search_tree_array[i+1].slice(0,n).reduce((acc,curr)=> acc + curr.length, 0); let last_child_idx=first_child_idx + this.search_tree_array[i+1][n].length - 1; return (x[x.length - 1][first_child_idx] + x[x.length - 1][last_child_idx])/2;}) );}}return x.reverse();}, linkage: function (){let links=[]; if (this.search_tree_array.length > 0){for ( let i=this.search_tree_array.length - 2; i > 0; i-- ){links.push( this.search_tree_array[i].flatMap((siblings,s)=>{let parent=this.node_x[i-1][s]; let parent_node=this.search_tree_array[i-1].flat()[s]; return siblings.map((node,n)=>{let node_idx=this.search_tree_array[i].slice(0,s).reduce((acc,curr)=> acc + curr.length, 0) + n; return{parent_loc: parent, child_loc: this.node_x[i][node_idx], label: parent_node.actions ? parent_node.actions[n] : ''}});}) );}}return links.reverse();},}, methods:{init_data: function (){this.search_tree=[];}, download: function (){let dldata={studentId: this.studentId, data_details: this.data_details, data: JSON.parse(JSON.stringify(this.search_tree))}; let j=document.createElement("a"); j.download="searchtree.json"; j.href=URL.createObjectURL(new Blob([JSON.stringify(dldata)])); j.click();}, upload_file: function (){if (this.upload.file !==undefined){const reader=new FileReader(); reader.onload=(ev)=>{try{let fileContent=JSON.parse(ev.target.result); this.studentId=fileContent.studentId; this.$nextTick().then(()=>{this.search_tree=fileContent.data.map(d=>{delete d.extracheck; return d});}).then(()=>{this.upload.overlay=false;}).catch(err=>{this.upload.error=err.message;});}catch (err){this.upload.error=err.message;}}; reader.readAsText(this.upload.file);}}, hoveredAdd: function (l,n){this.st_data.hovered_node=[l,n];}, hoveredRemove: function (){this.st_data.hovered_node=[-1,-1];}, hoveredCheckOpac: function (l,n){if (this.st_data.hovered_node[0]==l && this.st_data.hovered_node[1]==n){return .50;}else{return 0;}}, hoveredAddChildAdd: function (l,n){this.st_data.hovered_add_child_node=[l,n];}, hoveredAddChildRemove: function (){this.st_data.hovered_add_child_node=[-1,-1];}, hoveredAddChildCheckOpac: function (l,n){if (this.st_data.hovered_add_child_node[0]==l && this.st_data.hovered_add_child_node[1]==n){return .50;}else{return 0;}}, indexFromId: function (id){return this.search_tree.findIndex(el=> el.id==id);}, addChild: function (node){let newChild=JSON.parse(JSON.stringify(this.default_node)); if (node==undefined){newChild.id=1; this.search_tree.push(newChild);}else{newChild.id=Math.max(...this.search_tree.map(el=> el.id)) + 1; newChild.parent=node.id; this.search_tree.push(newChild); let indexOfParent=this.indexFromId(node.id); this.search_tree[indexOfParent].children.push(newChild.id); this.search_tree[indexOfParent].actions.push("x");}}, editNode: function (node){let indexOfNode=this.indexFromId(node.id); this.edit_data.overlay=true; this.edit_data.index=indexOfNode;}, deleteNode: function (){this.edit_data.overlay=false; let parentId=this.search_tree[this.edit_data.index].parent; let idToRemove=this.search_tree[this.edit_data.index].id; /* remove from children list of parent */ if (parentId !==null){let parentIndex=this.indexFromId(parentId); let indexInParent=this.search_tree[parentIndex].children.findIndex(x=> x==idToRemove); this.search_tree[parentIndex].children.splice(indexInParent, 1); this.search_tree[parentIndex].actions.splice(indexInParent, 1);}/* remove all children */ let idListToRemove=[]; let addChildId=(id)=>{idListToRemove.push(id); this.search_tree[this.indexFromId(id)].children.forEach(x=> addChildId(x));};addChildId(idToRemove); indexListToRemove=idListToRemove.map(x=> this.indexFromId(x)); indexListToRemove.sort((a,b)=> a < b); indexListToRemove.forEach(index=>{this.search_tree.splice(index, 1);}); if (this.edit_data.index >=this.search_tree.length){this.edit_data.index==0;}}, labelForChildAction: function (childAction){return `Action for the child ${this.search_tree[this.indexFromId(childAction[0])].state}`;}, moveUpChildAction: function (keys, index){if (index > 0){keys.forEach(k=>{this.search_tree[this.edit_data.index][k].splice(index - 1, 0, this.search_tree[this.edit_data.index][k].splice(index, 1)[0]);});}}, moveDownChildAction: function (keys, index){if (index < this.search_tree[this.edit_data.index][keys[0]].length - 1){keys.forEach(k=>{this.search_tree[this.edit_data.index][k].splice(index + 1, 0, this.search_tree[this.edit_data.index][k].splice(index, 1)[0]);});}}}}) </script></body></html>